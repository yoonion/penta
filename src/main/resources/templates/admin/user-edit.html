<!doctype html>
<html lang="en" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>회원 상세 정보</title>
</head>
<body>
<header th:replace="~{fragments/header :: header}"></header>
<main>
    <h1>회원 수정</h1>

    <div class="user-details">
        <p><strong>아이디:</strong> <span th:text="${user.userId}">아이디</span></p>
        <p>
            <strong>이름:</strong>
            <input type="text" th:value="${user.userNm}" id="userName" />
        </p>
        <p><strong>권한:</strong> <span th:text="${user.userAuth}">권한</span></p>
    </div>

    <div class="action-buttons">
        <button class="btn update-btn" id="updateBtn">수정하기</button>
    </div>
</main>

<script>
    // 사용자 수정
    document.getElementById('updateBtn').addEventListener('click', function() {
        const userId = "[[${user.userId}]]"; // 사용자 ID
        const updateName = document.getElementById('userName').value; // 수정할 이름

        if (updateName.trim() === "") {
            alert('이름을 입력하세요.');
            return;
        }

        // 수정 API 요청
        fetch('/api/users/' + userId, {
            method: 'PUT', // 수정 요청
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ userNm: updateName }) // JSON 형태로 보냄
        })
            .then(response => {
                if (response.ok) {
                    alert('수정되었습니다.');
                    location.href = '/admin/users/' + userId; // 회원 상세 페이지로 이동
                } else {
                    alert('수정 실패.');
                }
            })
            .catch(error => {
                alert('오류 발생: ' + error.message);
            });
    });
</script>
</body>
</html>
